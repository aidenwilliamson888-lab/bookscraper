<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âœ¨ OPEN LIBRARY Â· BANNER CENTER + ANIMASI Â· FINAL FIX</title>
    
    <!-- Google Fonts & Font Awesome -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* ============================================
           ROOT VARIABLES
           ============================================ */
        :root {
            --primary: #0f172a;
            --primary-light: #1e293b;
            --accent: #3b82f6;
            --accent-gradient: linear-gradient(135deg, #3b82f6, #8b5cf6);
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --gray-50: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-600: #475569;
            --gray-700: #334155;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Inter', sans-serif; 
            background: var(--gray-100); 
            padding: 40px 30px; 
            color: var(--primary);
        }

        .container { max-width: 1600px; margin: 0 auto; }

        /* ============================================
           ANIMASI KEYFRAMES - PASTI WORKING
           ============================================ */
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 10px 25px rgba(59,130,246,0.5); }
            50% { transform: scale(1.05); box-shadow: 0 15px 35px rgba(59,130,246,0.7); }
            100% { transform: scale(1); box-shadow: 0 10px 25px rgba(59,130,246,0.5); }
        }

        @keyframes pulseOrange {
            0% { transform: scale(1); box-shadow: 0 10px 25px rgba(245,158,11,0.5); }
            50% { transform: scale(1.05); box-shadow: 0 15px 35px rgba(245,158,11,0.7); }
            100% { transform: scale(1); box-shadow: 0 10px 25px rgba(245,158,11,0.5); }
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 200%; }
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0px); }
        }

        .pulse-animation {
            animation: pulse 2s infinite !important;
        }

        .pulse-orange-animation {
            animation: pulseOrange 2s infinite !important;
        }

        .float-animation {
            animation: float 3s ease-in-out infinite !important;
        }

        /* ============================================
           BANNER 1 - LIMITED TIME OFFER (CENTER + ANIMASI)
           ============================================ */
        .banner-1 {
            background: linear-gradient(145deg, rgba(0,0,0,0.82), rgba(10,20,30,0.92)), 
                        url('https://images.pexels.com/photos/2954199/pexels-photo-2954199.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2');
            background-size: cover;
            background-position: center;
            border-radius: 24px;
            padding: 45px 35px;
            text-align: center !important;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .banner-1-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            display: flex;
            justify-content: center !important;
            gap: 15px;
        }

        .banner-1-icon i {
            background: rgba(255,255,255,0.08);
            padding: 16px;
            border-radius: 50%;
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255,255,255,0.15);
        }

        .banner-1-title {
            font-size: 2.4rem;
            font-weight: 800;
            color: white;
            margin-bottom: 15px;
            text-shadow: 0 4px 15px rgba(0,0,0,0.6);
            letter-spacing: -0.02em;
            text-align: center !important;
        }

        .banner-1-subtitle {
            font-size: 1.3rem;
            color: white;
            margin-bottom: 25px;
            font-weight: 500;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            text-shadow: 0 2px 8px rgba(0,0,0,0.5);
            line-height: 1.5;
            text-align: center !important;
        }

        .banner-1-button {
            display: inline-block;
            background: linear-gradient(145deg, #3b82f6, #2563eb);
            color: white;
            padding: 18px 50px;
            border-radius: 60px;
            font-weight: 700;
            font-size: 1.2rem;
            text-decoration: none;
            box-shadow: 0 10px 25px rgba(59,130,246,0.5);
            transition: all 0.3s;
            border: 1px solid rgba(255,255,255,0.2);
            animation: pulse 2s infinite !important;
            text-align: center;
            margin: 0 auto;
        }

        .banner-1-button i {
            margin-left: 8px;
            transition: transform 0.3s;
        }

        .banner-1-button:hover i {
            transform: translateX(5px);
        }

        .banner-1-badge {
            margin-top: 25px;
            display: flex;
            justify-content: center !important;
            gap: 30px;
            color: rgba(255,255,255,0.9);
            font-size: 1rem;
            font-weight: 500;
        }

        .banner-1-badge i {
            margin-right: 8px;
            color: #f59e0b;
        }

        /* ============================================
           BANNER 2 - PREMIUM ACCESS (CENTER + ANIMASI)
           ============================================ */
        .banner-2 {
            background: linear-gradient(145deg, rgba(0,0,0,0.88), rgba(8,18,28,0.96)), 
                        url('https://images.pexels.com/photos/3944405/pexels-photo-3944405.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2');
            background-size: cover;
            background-position: center;
            border-radius: 28px;
            padding: 45px 50px;
            margin: 40px 0;
            position: relative;
            border: 1px solid rgba(255,255,255,0.15);
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
            text-align: center !important;
        }

        .banner-2::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #f59e0b, #ffb347, #f59e0b);
            border-radius: 30px;
            z-index: -1;
            opacity: 0.2;
            filter: blur(15px);
        }

        .banner-2-content {
            display: flex;
            flex-direction: column;
            align-items: center !important;
            justify-content: center !important;
            gap: 20px;
            text-align: center !important;
        }

        .banner-2-icon {
            margin-bottom: 5px;
        }

        .banner-2-icon i {
            font-size: 5rem;
            color: #ffd700;
            text-shadow: 0 0 30px rgba(255,215,0,0.9);
            background: rgba(0,0,0,0.4);
            padding: 20px;
            border-radius: 50%;
            backdrop-filter: blur(5px);
            border: 2px solid rgba(255,215,0,0.6);
            animation: float 3s ease-in-out infinite;
        }

        .banner-2-tag-container {
            display: flex;
            justify-content: center !important;
            align-items: center !important;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .banner-2-tag {
            display: inline-block;
            background: linear-gradient(145deg, #f59e0b, #d97706);
            padding: 10px 28px;
            border-radius: 60px;
            color: white;
            font-weight: 700;
            font-size: 1rem;
            border: 1px solid rgba(255,255,255,0.3);
            box-shadow: 0 4px 15px rgba(245,158,11,0.4);
            letter-spacing: 0.5px;
        }

        .banner-2-tag i {
            margin-right: 8px;
        }

        .banner-2-vip {
            display: inline-block;
            background: rgba(255,255,255,0.12);
            backdrop-filter: blur(6px);
            padding: 8px 22px;
            border-radius: 60px;
            color: white;
            font-size: 0.9rem;
            border: 1px solid rgba(255,255,255,0.2);
            font-weight: 600;
        }

        .banner-2-vip i {
            color: #ffd700;
            margin-right: 6px;
        }

        .banner-2-title {
            font-size: 2.4rem;
            font-weight: 800;
            color: white;
            margin-bottom: 12px;
            text-shadow: 0 4px 15px rgba(0,0,0,0.6);
            letter-spacing: -0.02em;
            text-align: center !important;
        }

        .banner-2-subtitle {
            font-size: 1.2rem;
            color: white;
            margin-bottom: 18px;
            font-weight: 500;
            text-shadow: 0 2px 8px rgba(0,0,0,0.5);
            text-align: center !important;
        }

        .banner-2-formats {
            display: flex;
            justify-content: center !important;
            align-items: center !important;
            gap: 25px;
            color: white;
            font-size: 1.05rem;
            flex-wrap: wrap;
            margin-bottom: 5px;
        }

        .banner-2-formats span {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .banner-2-formats i {
            color: #f59e0b;
            font-size: 1.1rem;
        }

        .banner-2-cta {
            margin-top: 20px;
            text-align: center !important;
        }

        .banner-2-button {
            display: inline-block;
            background: linear-gradient(145deg, #f59e0b, #d97706);
            color: white;
            padding: 18px 50px;
            border-radius: 60px;
            font-weight: 700;
            font-size: 1.2rem;
            text-decoration: none;
            box-shadow: 0 10px 25px rgba(245,158,11,0.5);
            transition: all 0.3s;
            border: 1px solid rgba(255,255,255,0.3);
            animation: pulseOrange 2s infinite !important;
            text-align: center;
        }

        .banner-2-button i {
            margin-right: 8px;
        }

        .banner-2-countdown {
            margin-top: 18px;
            display: inline-block;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(6px);
            padding: 12px 30px;
            border-radius: 60px;
            color: white;
            font-weight: 600;
            font-size: 1rem;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .banner-2-countdown i {
            color: #ffd700;
            margin-right: 8px;
        }

        /* ============================================
           BANNER 3 - GLASS MORPHISM (CENTER)
           ============================================ */
        .banner-3 {
            background: rgba(15,23,42,0.78);
            backdrop-filter: blur(14px);
            -webkit-backdrop-filter: blur(14px);
            border-radius: 20px;
            padding: 26px 35px;
            border: 1px solid rgba(255,255,255,0.12);
            box-shadow: 0 10px 35px rgba(0,0,0,0.25);
            margin-top: 30px;
            text-align: center !important;
        }

        .banner-3-content {
            display: flex;
            align-items: center !important;
            justify-content: center !important;
            gap: 45px;
            flex-wrap: wrap;
            text-align: center !important;
        }

        .banner-3-badge {
            display: flex;
            align-items: center;
            gap: 12px;
            color: white;
        }

        .banner-3-badge i {
            font-size: 1.5rem;
        }

        .banner-3-badge span {
            font-size: 1.05rem;
            font-weight: 500;
        }

        .banner-3-button {
            display: inline-block;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(6px);
            padding: 14px 38px;
            border-radius: 60px;
            color: white;
            font-weight: 700;
            text-decoration: none;
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.3s;
            font-size: 1.05rem;
        }

        .banner-3-button:hover {
            background: rgba(59,130,246,0.3);
            border-color: #3b82f6;
        }

        /* ============================================
           MAIN UI (SAMA SEPERTI SEBELUMNYA)
           ============================================ */
        .grid-main {
            display: grid;
            grid-template-columns: 1.1fr 1.4fr;
            gap: 35px;
        }

        @media (max-width: 1200px) { .grid-main { grid-template-columns: 1fr; } }

        .card {
            background: white;
            border-radius: 24px;
            padding: 35px;
            border: 1px solid var(--gray-200);
            box-shadow: 0 10px 30px rgba(0,0,0,0.02);
        }

        .card h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 2px solid var(--gray-200);
            padding-bottom: 20px;
        }

        .form-group { margin-bottom: 25px; }
        label { display: block; margin-bottom: 10px; font-weight: 600; color: var(--gray-700); }
        input, select, textarea {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--gray-200);
            border-radius: 16px;
            font-size: 1rem;
            background: var(--gray-50);
        }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 16px 28px;
            border-radius: 60px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
        }

        .btn:hover {
            background: var(--primary-light);
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(15,23,42,0.2);
        }

        .btn-success { background: var(--success); }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin: 25px 0;
        }

        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--gray-200);
            text-align: center;
        }

        .stat-value { font-size: 2rem; font-weight: 800; color: var(--primary); }

        .book-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            max-height: 600px;
            overflow-y: auto;
            padding: 20px;
            background: var(--gray-50);
            border-radius: 24px;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: var(--gray-200);
            border-radius: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--accent-gradient);
            width: 0%;
            transition: width 0.3s;
        }

        .title-mode-container {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--gray-50);
            border-radius: 24px;
        }

        .title-mode-option {
            flex: 1;
            padding: 20px;
            border-radius: 16px;
            background: white;
            border: 2px solid var(--gray-200);
            cursor: pointer;
        }

        .title-mode-option.active {
            border-color: var(--accent);
            background: linear-gradient(145deg, white, #f0f9ff);
        }
    </style>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="card" style="background: linear-gradient(145deg, #0f172a, #1e293b); color: white; margin-bottom: 35px;">
            <h1 style="color: white; border-bottom-color: rgba(255,255,255,0.2);">
                <i class="fas fa-crown" style="color: #f59e0b;"></i>
                OPEN LIBRARY Â· BANNER CENTER + ANIMASI WORKING
            </h1>
            <p style="font-size: 1.2rem; color: rgba(255,255,255,0.9);">
                âœ¦ BANNER 1: ANIMASI PULSE âœ¦ BANNER 2: ALL CENTER + ANIMASI âœ¦ KONTRAST TINGGI
            </p>
        </div>

        <div class="grid-main">
            <!-- LEFT PANEL - CONFIG -->
            <div class="card">
                <h2><i class="fas fa-sliders-h"></i> 1. Konfigurasi Massal</h2>
                
                <div class="form-group">
                    <label><i class="fas fa-key"></i> Keyword Utama</label>
                    <input type="text" id="keyword" value="the lightning thief" placeholder="contoh: harry potter, python, fiction">
                </div>

                <div class="form-group">
                    <label><i class="fas fa-globe"></i> Domain</label>
                    <input type="text" id="domain" value="free-ebooks-download.com" placeholder="domainkamu.com">
                </div>

                <div class="form-group">
                    <label><i class="fas fa-book"></i> Target Buku</label>
                    <select id="targetBooks">
                        <option value="100">100 buku</option>
                        <option value="300">300 buku</option>
                        <option value="500">500 buku</option>
                        <option value="1000" selected>1.000 buku</option>
                    </select>
                </div>

                <!-- TITLE MODE -->
                <div style="margin-bottom: 30px;">
                    <label><i class="fas fa-pencil-alt"></i> Mode Judul</label>
                    <div class="title-mode-container">
                        <div id="randomModeOption" class="title-mode-option active" onclick="setTitleMode('random')">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                <i class="fas fa-dice" style="font-size: 1.5rem; color: #3b82f6;"></i>
                                <h4 style="font-weight: 700;">Random Mode</h4>
                            </div>
                            <div style="font-size: 0.9rem; color: var(--gray-600);">6 variasi format Â· Setiap buku berbeda</div>
                        </div>
                        <div id="fixedModeOption" class="title-mode-option" onclick="setTitleMode('fixed')">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                                <i class="fas fa-check-circle" style="font-size: 1.5rem; color: #3b82f6;"></i>
                                <h4 style="font-weight: 700;">Fixed Mode</h4>
                            </div>
                            <div style="font-size: 0.9rem; color: var(--gray-600);">1 format pilihan Â· Semua buku sama</div>
                        </div>
                    </div>
                </div>

                <!-- FIXED MODE OPTIONS -->
                <div id="fixedModeOptions" style="display: none; margin-bottom: 30px; padding: 20px; background: var(--gray-50); border-radius: 24px;">
                    <label style="margin-bottom: 15px; display: block;">Pilih Format Fixed</label>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                        <div id="format1" class="format-item active" onclick="selectFixedFormat(1)" style="padding: 15px; background: white; border: 2px solid var(--gray-200); border-radius: 16px; cursor: pointer;">
                            <div style="font-weight: 600;">[Download] {title} by {author}</div>
                        </div>
                        <div id="format2" class="format-item" onclick="selectFixedFormat(2)" style="padding: 15px; background: white; border: 2px solid var(--gray-200); border-radius: 16px; cursor: pointer;">
                            <div style="font-weight: 600;">[PDF] {title} by {author}</div>
                        </div>
                        <div id="format3" class="format-item" onclick="selectFixedFormat(3)" style="padding: 15px; background: white; border: 2px solid var(--gray-200); border-radius: 16px; cursor: pointer;">
                            <div style="font-weight: 600;">[EPUB] {title} by {author}</div>
                        </div>
                        <div id="format4" class="format-item" onclick="selectFixedFormat(4)" style="padding: 15px; background: white; border: 2px solid var(--gray-200); border-radius: 16px; cursor: pointer;">
                            <div style="font-weight: 600;">[Download PDF] {title} by {author}</div>
                        </div>
                        <div id="format5" class="format-item" onclick="selectFixedFormat(5)" style="padding: 15px; background: white; border: 2px solid var(--gray-200); border-radius: 16px; cursor: pointer;">
                            <div style="font-weight: 600;">[Free Download] {title} by {author}</div>
                        </div>
                        <div id="format6" class="format-item" onclick="selectFixedFormat(6)" style="padding: 15px; background: white; border: 2px solid var(--gray-200); border-radius: 16px; cursor: pointer;">
                            <div style="font-weight: 600;">{title} by {author} [PDF/EPUB]</div>
                        </div>
                    </div>
                </div>

                <!-- SMARTLINK URL -->
                <div style="background: linear-gradient(145deg, #f0f9ff, white); border-left: 4px solid #3b82f6; padding: 25px; border-radius: 24px; margin-bottom: 25px;">
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
                        <i class="fas fa-bolt" style="font-size: 1.5rem; color: #3b82f6;"></i>
                        <h3 style="font-weight: 700;">ðŸ”— SMARTLINK URL (3 BANNER OTOMATIS)</h3>
                    </div>
                    <div class="form-group">
                        <input type="text" id="smartlink" value="https://adsterra.com/referral/your-id" placeholder="https://your-smartlink.com" style="border-color: #3b82f6;">
                    </div>
                </div>

                <!-- HISTATS -->
                <div style="background: var(--gray-50); border-radius: 24px; padding: 25px; margin-bottom: 25px;">
                    <label><i class="fas fa-chart-line"></i> Histats Script</label>
                    <textarea id="histatsScript" rows="4" style="margin-top: 15px; font-family: monospace;">&lt;!-- Histats.com START --&gt;
&lt;script&gt;
_Hasync.push([&apos;Histats.start&apos;, &apos;1,1234567,4,0,0,0,00000000&apos;]);
_Hasync.push([&apos;Histats.fasi&apos;, &apos;1&apos;]);
(function() {
  var hs = document.createElement(&apos;script&apos;); hs.async = true;
  hs.src = &apos;//s10.histats.com/js15_as.js&apos;;
  document.head.appendChild(hs);
})();
&lt;/script&gt;</textarea>
                </div>

                <!-- GENERATE BUTTON -->
                <button onclick="startMassGeneration()" class="btn" style="background: linear-gradient(135deg, #3b82f6, #8b5cf6); font-size: 1.2rem; padding: 20px;">
                    <i class="fas fa-magic"></i>
                    GENERATE 1.000+ BUKU Â· BANNER CENTER + ANIMASI
                </button>

                <!-- PROGRESS -->
                <div id="progressContainer" style="display: none; margin-top: 25px; padding: 25px; background: var(--gray-50); border-radius: 24px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                        <span id="progressStatus"><i class="fas fa-spinner fa-spin"></i> Memproses...</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill" style="width: 0%;"></div>
                    </div>
                    <p id="progressDetail" style="margin-top: 15px; color: var(--gray-600);"></p>
                </div>
            </div>

            <!-- RIGHT PANEL - PREVIEW BANNER -->
            <div class="card">
                <h2><i class="fas fa-chart-bar"></i> 2. Preview 3 Banner Premium (CENTER + ANIMASI)</h2>

                <!-- BANNER 1 - LIMITED TIME OFFER (ANIMASI WORKING) -->
                <div style="margin-bottom: 35px;">
                    <span style="background: #3b82f6; color: white; padding: 4px 16px; border-radius: 60px; font-size: 0.8rem; margin-bottom: 15px; display: inline-block; font-weight: 600;">
                        <i class="fas fa-bolt"></i> BANNER 1 Â· LIMITED TIME OFFER (ANIMASI PULSE)
                    </span>
                    <div id="bannerPreview1" class="banner-1">
                        <!-- Akan diisi JS -->
                    </div>
                </div>

                <!-- DESKRIPSI 7 PARAGRAF -->
                <div style="margin-bottom: 35px;">
                    <span style="background: #8b5cf6; color: white; padding: 4px 16px; border-radius: 60px; font-size: 0.8rem; margin-bottom: 15px; display: inline-block;">
                        <i class="fas fa-paragraph"></i> DESKRIPSI Â· 7 PARAGRAF PREMIUM
                    </span>
                    <div id="descriptionPreview" style="background: white; border-left: 6px solid #3b82f6; border-radius: 20px; padding: 35px; line-height: 1.8; border: 1px solid #e2e8f0;">
                        <!-- Akan diisi JS -->
                    </div>
                </div>

                <!-- BANNER 2 - PREMIUM ACCESS (CENTER + ANIMASI) -->
                <div style="margin-bottom: 35px;">
                    <span style="background: #f59e0b; color: black; padding: 4px 16px; border-radius: 60px; font-size: 0.8rem; margin-bottom: 15px; display: inline-block; font-weight: 700;">
                        <i class="fas fa-crown"></i> BANNER 2 Â· PREMIUM ACCESS (ALL CENTER + ANIMASI)
                    </span>
                    <div id="bannerPreview2" class="banner-2">
                        <!-- Akan diisi JS -->
                    </div>
                </div>

                <!-- BANNER 3 - GLASS MORPHISM -->
                <div style="margin-bottom: 35px;">
                    <span style="background: #10b981; color: white; padding: 4px 16px; border-radius: 60px; font-size: 0.8rem; margin-bottom: 15px; display: inline-block;">
                        <i class="fas fa-glass-cheers"></i> BANNER 3 Â· GLASS MORPHISM
                    </span>
                    <div id="bannerPreview3" class="banner-3">
                        <!-- Akan diisi JS -->
                    </div>
                </div>

                <!-- STATS -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="statTotalBooks">0</div>
                        <div class="stat-label">Total Buku</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="statCoverId">0</div>
                        <div class="stat-label">Cover ID</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="statNoCover">0</div>
                        <div class="stat-label">No Cover</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="statBanners">3</div>
                        <div class="stat-label">Smartlinks</div>
                    </div>
                </div>

                <!-- BOOK GRID -->
                <div style="margin-top: 25px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                        <span style="font-weight: 700;"><i class="fas fa-book-open"></i> Preview Buku</span>
                        <span id="bookCount" style="background: var(--primary); color: white; padding: 6px 20px; border-radius: 60px;">0 buku</span>
                    </div>
                    <div id="bookGridPreview" class="book-grid" style="min-height: 200px;"></div>
                </div>

                <!-- DOWNLOAD -->
                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <button onclick="downloadAll()" class="btn btn-success" id="downloadBtn" disabled style="flex: 2;">
                        <i class="fas fa-download"></i> ðŸ“¦ DOWNLOAD ZIP
                    </button>
                    <button onclick="downloadSitemap()" class="btn" id="sitemapBtn" disabled style="flex: 1; background: var(--accent);">
                        <i class="fas fa-sitemap"></i> SITEMAP
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // OPEN LIBRARY Â· 3 BANNER PREMIUM FINAL FIX
        // BANNER 1: ANIMASI PULSE WORKING
        // BANNER 2: ALL CENTER + ANIMASI WORKING
        // ============================================
        
        const CORS_PROXY = 'https://api.allorigins.win/raw?url=';
        const OPEN_LIBRARY_SEARCH = 'https://openlibrary.org/search.json';
        
        // TITLE MODE
        let currentTitleMode = 'random';
        let currentFixedFormat = 1;
        
        const RANDOM_TITLE_FORMATS = [
            (t, a) => `[Download] ${t} by ${a}`,
            (t, a) => `[PDF] ${t} by ${a}`,
            (t, a) => `[EPUB] ${t} by ${a}`,
            (t, a) => `[Download PDF] ${t} by ${a}`,
            (t, a) => `[Free Download] ${t} by ${a}`,
            (t, a) => `${t} by ${a} [PDF/EPUB]`
        ];
        
        const FIXED_TITLE_FORMATS = [
            (t, a) => `[Download] ${t} by ${a}`,
            (t, a) => `[PDF] ${t} by ${a}`,
            (t, a) => `[EPUB] ${t} by ${a}`,
            (t, a) => `[Download PDF] ${t} by ${a}`,
            (t, a) => `[Free Download] ${t} by ${a}`,
            (t, a) => `${t} by ${a} [PDF/EPUB]`
        ];

        // GLOBAL
        let books = [];
        let coverStats = { coverId: 0, coverEdition: 0, isbn: 0, noCover: 0 };
        let isGenerating = false;

        // ============================================
        // 7 PARAGRAPH PREMIUM DESCRIPTION
        // ============================================
        function generatePremiumDescription(doc) {
            const title = doc.title || 'Untitled';
            const author = doc.author_name ? doc.author_name[0] : 'Unknown Author';
            const year = doc.first_publish_year || (doc.publish_year ? doc.publish_year[0] : 'Unknown');
            const publisher = doc.publisher ? doc.publisher[0] : '';
            const cleanPublisher = (publisher && publisher !== 'Unknown Publisher' && !publisher.includes('Unknown')) ? publisher : '';
            
            let desc = '';
            
            desc += `<p><strong><i class="fas fa-book"></i> Download or Read Online ${title} ebook (PDF ePub Mobi) - ${author}, published in ${year}${cleanPublisher ? ` by ${cleanPublisher}` : ''}.</strong> This comprehensive work is available through Open Library's digital collection, offering readers worldwide access to this valuable resource.</p>\n`;
            
            if (doc.first_sentence) {
                desc += `<p><i class="fas fa-quote-left"></i> ${doc.first_sentence} This opening sets the stage for what promises to be an engaging exploration of the subject matter.</p>\n`;
            } else {
                desc += `<p><i class="fas fa-info-circle"></i> ${title} represents a significant contribution to the field, showcasing ${author}'s expertise and deep understanding of the subject. The book has garnered attention from readers and critics alike for its comprehensive approach and engaging writing style.</p>\n`;
            }
            
            if (doc.subject && doc.subject.length > 0) {
                let subjects = doc.subject.slice(0, 7).join(', ');
                desc += `<p><strong><i class="fas fa-tags"></i> Topics Covered:</strong> This book delves into ${subjects}, providing readers with a thorough understanding of these interconnected themes. Each chapter builds upon the last, creating a cohesive learning experience that will benefit readers at any level.</p>\n`;
            } else {
                desc += `<p><strong><i class="fas fa-tags"></i> Content Overview:</strong> The book is structured to guide readers from fundamental concepts to advanced applications. Whether you're new to the subject or looking to deepen your knowledge, this book offers valuable insights at every level with clear explanations and practical examples.</p>\n`;
            }
            
            desc += `<p><strong><i class="fas fa-user"></i> About the Author:</strong> ${author} brings years of experience and research to this work. Known for their ability to explain complex topics with clarity and insight, ${author} has established themselves as a trusted voice in the field. This book represents the culmination of their expertise and dedication, offering readers a unique perspective on the subject matter.</p>\n`;
            
            desc += `<p><strong><i class="fas fa-graduation-cap"></i> What You'll Learn:</strong> Through ${title}, readers will gain practical knowledge that can be applied immediately. The book covers essential theories, real-world applications, and emerging trends. Each section includes detailed examples, case studies, and practical exercises that bring the concepts to life and ensure deep understanding.</p>\n`;
            
            desc += `<p><strong><i class="fas fa-users"></i> Who This Book Is For:</strong> This book is ideal for students, professionals, and enthusiasts who want to master the subject. The clear explanations make it accessible for beginners, while the depth of content ensures even experienced readers will find new insights and perspectives. Educators will also find this to be an excellent resource for course material and classroom discussion.</p>\n`;
            
            desc += `<p><strong><i class="fas fa-mobile-alt"></i> Available Formats:</strong> You can read ${title} online for free through Open Library, or download it in multiple digital formats including PDF, EPUB, and MOBI. These formats are compatible with all major e-readers, tablets, and smartphones. Start reading today and join thousands of readers who have already benefited from this remarkable book. The digital edition maintains all the richness of the print version with added convenience and accessibility.</p>`;
            
            return desc;
        }

        // ============================================
        // SET TITLE MODE
        // ============================================
        function setTitleMode(mode) {
            currentTitleMode = mode;
            if (mode === 'random') {
                document.getElementById('randomModeOption').classList.add('active');
                document.getElementById('fixedModeOption').classList.remove('active');
                document.getElementById('fixedModeOptions').style.display = 'none';
            } else {
                document.getElementById('fixedModeOption').classList.add('active');
                document.getElementById('randomModeOption').classList.remove('active');
                document.getElementById('fixedModeOptions').style.display = 'block';
            }
        }

        function selectFixedFormat(format) {
            currentFixedFormat = format;
            for (let i = 1; i <= 6; i++) {
                const el = document.getElementById(`format${i}`);
                if (el) {
                    if (i === format) el.classList.add('active');
                    else el.classList.remove('active');
                }
            }
        }

        // ============================================
        // UPDATE BANNER PREVIEWS - FINAL FIX
        // BANNER 1: ANIMASI PULSE WORKING
        // BANNER 2: ALL CENTER + ANIMASI WORKING
        // ============================================
        function updateBannerPreviews(smartlink) {
            // BANNER 1 - LIMITED TIME OFFER (ANIMASI PULSE WORKING)
            document.getElementById('bannerPreview1').innerHTML = `
                <div class="banner-1-icon">
                    <i class="fas fa-bolt" style="color: #f59e0b;"></i>
                    <i class="fas fa-book" style="color: #3b82f6;"></i>
                </div>
                <div class="banner-1-title">âš¡ LIMITED TIME OFFER âš¡</div>
                <div class="banner-1-subtitle">Download this book + 50,000 more premium ebooks for FREE!</div>
                <a href="${smartlink}" class="banner-1-button" target="_blank" style="animation: pulse 2s infinite !important;">
                    GET ACCESS NOW <i class="fas fa-arrow-right"></i>
                </a>
                <div class="banner-1-badge">
                    <span><i class="fas fa-shield-alt"></i> 100% Safe</span>
                    <span><i class="fas fa-credit-card"></i> No Credit Card Required</span>
                </div>
            `;

            // BANNER 2 - PREMIUM ACCESS (ALL CENTER + ANIMASI WORKING)
            document.getElementById('bannerPreview2').innerHTML = `
                <div class="banner-2-content">
                    <div class="banner-2-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    
                    <div class="banner-2-tag-container">
                        <span class="banner-2-tag">
                            <i class="fas fa-bolt"></i> PREMIUM ACCESS
                        </span>
                        <span class="banner-2-vip">
                            <i class="fas fa-star"></i> VIP
                        </span>
                    </div>
                    
                    <div class="banner-2-title">Get Unlimited Downloads</div>
                    <div class="banner-2-subtitle">PDF Â· EPUB Â· MOBI Â· Audiobooks</div>
                    
                    <div class="banner-2-formats">
                        <span><i class="fas fa-file-pdf"></i> PDF</span>
                        <span><i class="fas fa-book"></i> EPUB</span>
                        <span><i class="fas fa-mobile-alt"></i> MOBI</span>
                        <span><i class="fas fa-headphones"></i> Audiobooks</span>
                    </div>
                    
                    <div class="banner-2-cta">
                        <a href="${smartlink}" class="banner-2-button" target="_blank" style="animation: pulseOrange 2s infinite !important;">
                            <i class="fas fa-bolt"></i> CLAIM NOW
                        </a>
                        <div class="banner-2-countdown">
                            <i class="fas fa-clock"></i> Offer ends in: 10:00
                        </div>
                    </div>
                </div>
            `;

            // BANNER 3 - GLASS MORPHISM
            document.getElementById('bannerPreview3').innerHTML = `
                <div class="banner-3-content">
                    <div class="banner-3-badge">
                        <i class="fas fa-check-circle" style="color: #10b981;"></i>
                        <span>1M+ Downloads</span>
                    </div>
                    <div class="banner-3-badge">
                        <i class="fas fa-star" style="color: #f59e0b;"></i>
                        <span>4.8/5 Rating</span>
                    </div>
                    <div class="banner-3-badge">
                        <i class="fas fa-lock" style="color: #3b82f6;"></i>
                        <span>Secure Download</span>
                    </div>
                    <a href="${smartlink}" class="banner-3-button" target="_blank">
                        <i class="fas fa-download"></i> Download Free
                    </a>
                </div>
            `;
        }

        // ============================================
        // UPDATE DESCRIPTION PREVIEW
        // ============================================
        function updateDescriptionPreview() {
            const sampleDoc = {
                title: "The Lightning Thief",
                author_name: ["Rick Riordan"],
                first_publish_year: "2005",
                publisher: ["Miramax Books"],
                subject: ["Fantasy", "Mythology", "Young Adult", "Adventure", "Greek Mythology"],
                first_sentence: "Look, I didn't want to be a half-blood."
            };
            const previewDesc = generatePremiumDescription(sampleDoc);
            document.getElementById('descriptionPreview').innerHTML = `
                <h2 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-quote-right" style="color: #3b82f6;"></i> Book Description
                </h2>
                ${previewDesc}
            `;
        }

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function generateRandomId() {
            const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
            let id = '';
            for (let i = 0; i < 8; i++) id += chars.charAt(Math.floor(Math.random() * chars.length));
            return id;
        }

        function generateSlug(title, author) {
            const t = title.toLowerCase().replace(/[^\w\s]/g, '').replace(/\s+/g, '-').substring(0, 50);
            const a = author.toLowerCase().replace(/[^\w\s]/g, '').replace(/\s+/g, '-').substring(0, 30);
            return `${t}-by-${a}-${generateRandomId()}.html`;
        }

        function getCoverUrl(doc) {
            if (doc.cover_i) {
                coverStats.coverId++;
                return { url: `https://covers.openlibrary.org/b/id/${doc.cover_i}-L.jpg`, source: 'Cover ID', hasCover: true };
            }
            if (doc.cover_edition_key) {
                coverStats.coverEdition++;
                return { url: `https://covers.openlibrary.org/b/olid/${doc.cover_edition_key}-L.jpg`, source: 'Cover Edition', hasCover: true };
            }
            if (doc.isbn && doc.isbn.length > 0) {
                coverStats.isbn++;
                return { url: `https://covers.openlibrary.org/b/isbn/${doc.isbn[0]}-L.jpg`, source: 'ISBN', hasCover: true };
            }
            coverStats.noCover++;
            return { url: null, source: 'No Cover', hasCover: false };
        }

        function cleanPublisher(publisher) {
            if (!publisher || publisher === 'Unknown Publisher' || publisher.includes('Unknown')) return '';
            return publisher;
        }

        function getFormattedTitle(title, author) {
            if (currentTitleMode === 'random') {
                const randomIndex = Math.floor(Math.random() * RANDOM_TITLE_FORMATS.length);
                return RANDOM_TITLE_FORMATS[randomIndex](title, author);
            } else {
                return FIXED_TITLE_FORMATS[currentFixedFormat - 1](title, author);
            }
        }

        function processBook(doc) {
            const title = doc.title || 'Untitled';
            const author = doc.author_name ? doc.author_name[0] : 'Unknown Author';
            const publisher = cleanPublisher(doc.publisher ? doc.publisher[0] : '');
            const year = doc.first_publish_year || (doc.publish_year ? doc.publish_year[0] : 'Unknown');
            const coverData = getCoverUrl(doc);
            const formattedTitle = getFormattedTitle(title, author);
            const slug = generateSlug(title, author);
            
            return {
                id: generateRandomId(),
                title, author, publisher, year,
                coverUrl: coverData.url,
                coverSource: coverData.source,
                hasCover: coverData.hasCover,
                description: generatePremiumDescription(doc),
                formattedTitle, 
                filename: slug,
                olUrl: doc.key ? `https://openlibrary.org${doc.key}` : `https://openlibrary.org/search?q=${encodeURIComponent(title)}`
            };
        }

        async function fetchWithProxy(url, retryCount = 0) {
            const proxies = [
                'https://api.allorigins.win/raw?url=',
                'https://corsproxy.io/?',
                'https://api.codetabs.com/v1/proxy?quest='
            ];
            
            const proxy = proxies[retryCount % proxies.length];
            const proxyUrl = proxy + encodeURIComponent(url);
            
            try {
                const response = await fetch(proxyUrl);
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                return await response.text();
            } catch (e) {
                if (retryCount < proxies.length * 2) {
                    await new Promise(r => setTimeout(r, 1000));
                    return fetchWithProxy(url, retryCount + 1);
                }
                throw e;
            }
        }

        // ============================================
        // MASS GENERATION
        // ============================================
        async function startMassGeneration() {
            if (isGenerating) {
                alert('Proses sedang berjalan. Tunggu selesai.');
                return;
            }
            
            const keyword = document.getElementById('keyword').value.trim();
            const target = parseInt(document.getElementById('targetBooks').value);
            const smartlink = document.getElementById('smartlink').value.trim();
            
            if (!keyword) { alert('Masukkan keyword!'); return; }
            if (!smartlink) { alert('Masukkan Smartlink URL!'); return; }
            
            updateBannerPreviews(smartlink);
            
            isGenerating = true;
            books = [];
            coverStats = { coverId: 0, coverEdition: 0, isbn: 0, noCover: 0 };
            
            document.getElementById('progressContainer').style.display = 'block';
            document.getElementById('downloadBtn').disabled = true;
            document.getElementById('sitemapBtn').disabled = true;
            document.getElementById('statTotalBooks').innerHTML = '0';
            document.getElementById('bookCount').innerHTML = '0 buku';
            
            try {
                const PAGE_SIZE = 100;
                const pagesNeeded = Math.ceil(target / PAGE_SIZE);
                let collected = 0;
                
                for (let page = 0; page < pagesNeeded; page++) {
                    if (collected >= target) break;
                    
                    const offset = page * PAGE_SIZE;
                    const url = `${OPEN_LIBRARY_SEARCH}?q=${encodeURIComponent(keyword)}&limit=${PAGE_SIZE}&offset=${offset}`;
                    
                    document.getElementById('progressStatus').innerHTML = `<i class="fas fa-spinner fa-spin"></i> Halaman ${page + 1}/${pagesNeeded}`;
                    
                    try {
                        const text = await fetchWithProxy(url);
                        const data = JSON.parse(text);
                        
                        if (!data.docs || data.docs.length === 0) break;
                        
                        for (const doc of data.docs) {
                            if (collected >= target) break;
                            books.push(processBook(doc));
                            collected++;
                            
                            if (collected % 5 === 0) {
                                const percent = Math.min(Math.round(collected / target * 100), 100);
                                document.getElementById('progressFill').style.width = percent + '%';
                                document.getElementById('progressPercent').innerHTML = percent + '%';
                                document.getElementById('statTotalBooks').innerHTML = collected;
                                document.getElementById('bookCount').innerHTML = collected + ' buku';
                                document.getElementById('statCoverId').innerHTML = coverStats.coverId;
                                document.getElementById('statNoCover').innerHTML = coverStats.noCover;
                            }
                            
                            await new Promise(r => setTimeout(r, 5));
                        }
                        
                        await new Promise(r => setTimeout(r, 500));
                        
                    } catch (e) {
                        console.error(`Error page ${page + 1}:`, e);
                        continue;
                    }
                }
                
                isGenerating = false;
                document.getElementById('progressStatus').innerHTML = '<i class="fas fa-check-circle"></i> Selesai!';
                document.getElementById('progressFill').style.width = '100%';
                document.getElementById('progressPercent').innerHTML = '100%';
                document.getElementById('statTotalBooks').innerHTML = books.length;
                document.getElementById('bookCount').innerHTML = books.length + ' buku';
                document.getElementById('downloadBtn').disabled = false;
                document.getElementById('sitemapBtn').disabled = false;
                
                // UPDATE PREVIEW GRID
                updatePreviewGrid();
                
            } catch (e) {
                console.error(e);
                alert('Error: ' + e.message);
                isGenerating = false;
            }
        }

        function updatePreviewGrid() {
            const grid = document.getElementById('bookGridPreview');
            let html = '';
            
            books.slice(0, 12).forEach(book => {
                if (book.hasCover) {
                    html += `<div style="background: white; border-radius: 16px; padding: 16px; border: 1px solid #e2e8f0;">
                        <img src="${book.coverUrl}" style="width:100%; height:160px; object-fit:contain; margin-bottom:12px;" 
                             onerror="this.src='https://via.placeholder.com/400x600/e2e8f0/4a5a6a?text=No+Cover'">
                        <div style="font-weight:600; font-size:0.9rem;">${book.title.substring(0, 35)}...</div>
                        <div style="font-size:0.8rem; color:#475569;">${book.author}</div>
                    </div>`;
                } else {
                    html += `<div style="background: white; border-radius: 16px; padding: 16px; border: 1px solid #e2e8f0;">
                        <div style="width:100%; height:160px; background:#e2e8f0; display:flex; align-items:center; justify-content:center; border-radius:8px;">
                            <i class="fas fa-book" style="font-size:2rem; color:#64748b;"></i>
                        </div>
                        <div style="font-weight:600; font-size:0.9rem; margin-top:10px;">${book.title.substring(0, 35)}...</div>
                        <div style="font-size:0.8rem; color:#475569;">${book.author}</div>
                    </div>`;
                }
            });
            
            grid.innerHTML = html;
        }

        // ============================================
        // GENERATE LANDING PAGE - FINAL FIX
        // ============================================
        function generateLandingPage(book, domain, smartlink, histatsScript) {
            const year = new Date().getFullYear();
            const today = new Date().toLocaleDateString('en-US', { day: 'numeric', month: 'long', year: 'numeric' });
            const publisherDisplay = book.publisher ? ` Â· ${book.publisher}` : '';
            
            // BANNER 1 - LIMITED TIME OFFER (ANIMASI PULSE)
            const banner1 = `
                <div class="banner-1">
                    <div class="banner-1-icon">
                        <i class="fas fa-bolt" style="color: #f59e0b;"></i>
                        <i class="fas fa-book" style="color: #3b82f6;"></i>
                    </div>
                    <div class="banner-1-title">âš¡ LIMITED TIME OFFER âš¡</div>
                    <div class="banner-1-subtitle">Download this book + 50,000 more premium ebooks for FREE!</div>
                    <a href="${smartlink}" class="banner-1-button" target="_blank" style="animation: pulse 2s infinite !important;">
                        GET ACCESS NOW <i class="fas fa-arrow-right"></i>
                    </a>
                    <div class="banner-1-badge">
                        <span><i class="fas fa-shield-alt"></i> 100% Safe</span>
                        <span><i class="fas fa-credit-card"></i> No Credit Card Required</span>
                    </div>
                </div>`;

            // BANNER 2 - PREMIUM ACCESS (ALL CENTER + ANIMASI)
            const banner2 = `
                <div class="banner-2">
                    <div class="banner-2-content">
                        <div class="banner-2-icon">
                            <i class="fas fa-crown"></i>
                        </div>
                        
                        <div class="banner-2-tag-container">
                            <span class="banner-2-tag">
                                <i class="fas fa-bolt"></i> PREMIUM ACCESS
                            </span>
                            <span class="banner-2-vip">
                                <i class="fas fa-star"></i> VIP
                            </span>
                        </div>
                        
                        <div class="banner-2-title">Get Unlimited Downloads</div>
                        <div class="banner-2-subtitle">PDF Â· EPUB Â· MOBI Â· Audiobooks</div>
                        
                        <div class="banner-2-formats">
                            <span><i class="fas fa-file-pdf"></i> PDF</span>
                            <span><i class="fas fa-book"></i> EPUB</span>
                            <span><i class="fas fa-mobile-alt"></i> MOBI</span>
                            <span><i class="fas fa-headphones"></i> Audiobooks</span>
                        </div>
                        
                        <div class="banner-2-cta">
                            <a href="${smartlink}" class="banner-2-button" target="_blank" style="animation: pulseOrange 2s infinite !important;">
                                <i class="fas fa-bolt"></i> CLAIM NOW
                            </a>
                            <div class="banner-2-countdown">
                                <i class="fas fa-clock"></i> Offer ends in: 10:00
                            </div>
                        </div>
                    </div>
                </div>`;

            // BANNER 3 - GLASS MORPHISM
            const banner3 = `
                <div class="banner-3">
                    <div class="banner-3-content">
                        <div class="banner-3-badge">
                            <i class="fas fa-check-circle" style="color: #10b981;"></i>
                            <span>1M+ Downloads</span>
                        </div>
                        <div class="banner-3-badge">
                            <i class="fas fa-star" style="color: #f59e0b;"></i>
                            <span>4.8/5 Rating</span>
                        </div>
                        <div class="banner-3-badge">
                            <i class="fas fa-lock" style="color: #3b82f6;"></i>
                            <span>Secure Download</span>
                        </div>
                        <a href="${smartlink}" class="banner-3-button" target="_blank">
                            <i class="fas fa-download"></i> Download Free
                        </a>
                    </div>
                </div>`;

            let coverHtml = book.hasCover 
                ? `<img src="${book.coverUrl}" alt="${book.title}" style="width:100%; border-radius:16px;" onerror="this.src='https://via.placeholder.com/400x600/e2e8f0/4a5a6a?text=No+Cover'">`
                : `<div style="width:100%; height:100%; min-height:300px; background:linear-gradient(145deg, #e2e8f0, #d0d8e0); display:flex; flex-direction:column; align-items:center; justify-content:center; border-radius:16px; padding:30px;">
                    <i class="fas fa-book" style="font-size:3rem; color:#475569;"></i>
                    <div style="margin-top:15px; color:#475569; font-weight:500;">No Cover Available</div>
                   </div>`;

            return `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${book.formattedTitle}</title>
    <meta name="description" content="Download or Read Online ${book.title} ebook (PDF ePub Mobi) - ${book.author}, published in ${book.year}. Free access via Open Library.">
    <link rel="canonical" href="https://${domain}/${book.filename}">
    <meta property="og:title" content="${book.formattedTitle}">
    <meta property="og:description" content="Download or Read Online ${book.title} ebook - ${book.author}, ${book.year}">
    <meta property="og:image" content="${book.hasCover ? book.coverUrl : 'https://via.placeholder.com/400x600/e2e8f0/4a5a6a?text=No+Cover'}">
    <meta property="og:url" content="https://${domain}/${book.filename}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family: 'Inter', sans-serif; background: #f8fafc; padding: 30px 20px; }
        .container { max-width: 1100px; margin: 0 auto; }
        .card { background: white; border-radius: 32px; padding: 45px; border: 1px solid #e2e8f0; box-shadow: 0 20px 40px rgba(0,0,0,0.02); }
        .header { display: flex; gap: 40px; margin-bottom: 40px; flex-wrap: wrap; }
        .cover { flex: 0 0 250px; }
        h1 { font-size: 2rem; font-weight: 800; margin-bottom: 15px; color: #0f172a; line-height: 1.2; }
        .meta { color: #475569; margin-bottom: 25px; }
        .btn { padding: 16px 32px; border-radius: 60px; font-weight: 700; text-decoration: none; display: inline-flex; align-items: center; gap: 12px; transition: 0.3s; flex:1; }
        .btn-primary { background: #0f172a; color: white; }
        .btn-ads { background: #f59e0b; color: white; }
        .button-group { display: flex; gap: 20px; margin: 30px 0; flex-wrap: wrap; }
        .description { background: white; border-left: 6px solid #3b82f6; border-radius: 20px; padding: 35px; margin: 40px 0; line-height: 1.8; }
        .description p { margin-bottom: 20px; color: #1e293b; font-size: 1.05rem; }
        .description i { color: #3b82f6; margin-right: 10px; width: 24px; text-align: center; }
        .footer { margin-top: 50px; padding-top: 30px; border-top: 1px solid #e2e8f0; color: #64748b; text-align: center; }
        .id-badge { display: inline-block; background: #0f172a; color: white; padding: 6px 20px; border-radius: 60px; font-size: 0.8rem; margin-bottom: 20px; }
        
        .banner-1, .banner-2, .banner-3 { margin-bottom: 30px; }
        .banner-1 { background: linear-gradient(145deg, rgba(0,0,0,0.82), rgba(10,20,30,0.92)), url('https://images.pexels.com/photos/2954199/pexels-photo-2954199.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2'); background-size: cover; background-position: center; border-radius: 24px; padding: 45px 35px; text-align: center !important; }
        .banner-2 { background: linear-gradient(145deg, rgba(0,0,0,0.88), rgba(8,18,28,0.96)), url('https://images.pexels.com/photos/3944405/pexels-photo-3944405.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2'); background-size: cover; background-position: center; border-radius: 28px; padding: 45px 50px; margin: 40px 0; text-align: center !important; }
        .banner-3 { background: rgba(15,23,42,0.78); backdrop-filter: blur(14px); border-radius: 20px; padding: 26px 35px; border: 1px solid rgba(255,255,255,0.12); margin-top: 30px; text-align: center !important; }
        
        .banner-1-title { font-size: 2.4rem; font-weight: 800; color: white; text-shadow: 0 4px 15px rgba(0,0,0,0.6); text-align: center !important; }
        .banner-1-subtitle { font-size: 1.3rem; color: white; text-shadow: 0 2px 8px rgba(0,0,0,0.5); text-align: center !important; }
        .banner-1-button { display: inline-block; background: linear-gradient(145deg, #3b82f6, #2563eb); color: white; padding: 18px 50px; border-radius: 60px; font-weight: 700; font-size: 1.2rem; text-decoration: none; animation: pulse 2s infinite !important; text-align: center; }
        .banner-1-badge { display: flex; justify-content: center !important; gap: 30px; color: rgba(255,255,255,0.9); margin-top: 25px; }
        
        .banner-2-content { display: flex; flex-direction: column; align-items: center !important; justify-content: center !important; gap: 20px; text-align: center !important; }
        .banner-2-icon i { font-size: 5rem; color: #ffd700; text-shadow: 0 0 30px rgba(255,215,0,0.9); }
        .banner-2-tag-container { display: flex; justify-content: center !important; align-items: center !important; gap: 15px; margin-bottom: 15px; flex-wrap: wrap; }
        .banner-2-tag { background: linear-gradient(145deg, #f59e0b, #d97706); color: white; padding: 10px 28px; border-radius: 60px; display: inline-block; }
        .banner-2-title { font-size: 2.4rem; font-weight: 800; color: white; text-shadow: 0 4px 15px rgba(0,0,0,0.6); text-align: center !important; }
        .banner-2-subtitle { color: white; font-size: 1.2rem; text-align: center !important; }
        .banner-2-formats { display: flex; justify-content: center !important; align-items: center !important; gap: 25px; color: white; flex-wrap: wrap; }
        .banner-2-button { display: inline-block; background: linear-gradient(145deg, #f59e0b, #d97706); color: white; padding: 18px 50px; border-radius: 60px; font-weight: 700; font-size: 1.2rem; text-decoration: none; animation: pulseOrange 2s infinite !important; text-align: center; }
        .banner-2-countdown { display: inline-block; background: rgba(0,0,0,0.6); color: white; padding: 12px 30px; border-radius: 60px; margin-top: 18px; }
        
        .banner-3-content { display: flex; align-items: center !important; justify-content: center !important; gap: 45px; flex-wrap: wrap; text-align: center !important; }
        .banner-3-badge { display: flex; align-items: center; gap: 12px; color: white; }
        .banner-3-button { display: inline-block; background: rgba(255,255,255,0.1); backdrop-filter: blur(6px); color: white; padding: 14px 38px; border-radius: 60px; text-decoration: none; }
        
        @keyframes pulse { 0% { transform: scale(1); box-shadow: 0 10px 25px rgba(59,130,246,0.5); } 50% { transform: scale(1.05); box-shadow: 0 15px 35px rgba(59,130,246,0.7); } 100% { transform: scale(1); box-shadow: 0 10px 25px rgba(59,130,246,0.5); } }
        @keyframes pulseOrange { 0% { transform: scale(1); box-shadow: 0 10px 25px rgba(245,158,11,0.5); } 50% { transform: scale(1.05); box-shadow: 0 15px 35px rgba(245,158,11,0.7); } 100% { transform: scale(1); box-shadow: 0 10px 25px rgba(245,158,11,0.5); } }
        
        @media (max-width: 768px) { .card { padding: 25px; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            ${banner1}
            
            <span class="id-badge">
                <i class="fas fa-fingerprint"></i> ID: ${book.id} Â· ${book.coverSource}
            </span>
            
            <div class="header">
                <div class="cover">${coverHtml}</div>
                <div style="flex:1;">
                    <h1>${book.formattedTitle}</h1>
                    <div class="meta">
                        <i class="fas fa-user"></i> <strong>${book.author}</strong> Â· 
                        <i class="fas fa-calendar"></i> ${book.year}${publisherDisplay}
                    </div>
                    
                    <div class="button-group">
                        <a href="${book.olUrl}" class="btn btn-primary" target="_blank">
                            <i class="fas fa-book-open"></i> Read at Open Library
                        </a>
                        <a href="${smartlink}" class="btn btn-ads" target="_blank">
                            <i class="fas fa-bolt"></i> Download via Partner
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="description">
                <h2 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-quote-right" style="color: #3b82f6;"></i> Book Description
                </h2>
                ${book.description}
            </div>
            
            ${banner2}
            ${banner3}
            
            <div class="footer">
                <p>Â© ${year} ${domain} Â· Free Book Download Portal</p>
                <p style="margin-top: 12px; font-size: 0.8rem;">
                    <i class="fas fa-database"></i> Source: Open Library Â· 
                    <i class="fas fa-file"></i> ID: ${book.id} Â· 
                    <i class="fas fa-clock"></i> Generated: ${today}
                </p>
            </div>
        </div>
    </div>
    ${histatsScript}
</body>
</html>`;
        }

        // ============================================
        // SITEMAP & INDEX
        // ============================================
        function generateSitemap(books, domain) {
            let xml = '<?xml version="1.0" encoding="UTF-8"?>\n<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">\n';
            books.forEach(b => {
                xml += `  <url>\n    <loc>https://${domain}/${b.filename}</loc>\n`;
                xml += `    <lastmod>${new Date().toISOString().split('T')[0]}</lastmod>\n`;
                xml += `    <changefreq>monthly</changefreq>\n    <priority>0.7</priority>\n  </url>\n`;
            });
            xml += '</urlset>';
            return xml;
        }

        function generateIndexHTML(books, domain) {
            let html = `<!DOCTYPE html>
<html lang="en">
<head><meta charset="UTF-8"><title>ðŸ“š ${books.length} Free eBooks - ${domain}</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Inter',sans-serif;background:#f8fafc;padding:40px;color:#0f172a;}
    .container{max-width:1200px;margin:0 auto;}
    h1{font-size:2rem;margin-bottom:30px;display:flex;align-items:center;gap:15px;}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:25px;}
    .card{background:white;border-radius:20px;padding:20px;border:1px solid #e2e8f0;}
    img{width:100%;height:200px;object-fit:contain;margin-bottom:15px;}
    .nocover{width:100%;height:200px;background:#e2e8f0;display:flex;align-items:center;justify-content:center;}
    a{display:inline-block;background:#0f172a;color:white;padding:10px 24px;border-radius:40px;text-decoration:none;margin-top:15px;}
</style>
</head>
<body>
<div class="container">
<h1><i class="fas fa-crown" style="color:#f59e0b;"></i> ${books.length} Free eBooks Download</h1>
<div class="grid">`;
            
            books.slice(0, 50).forEach(b => {
                html += `<div class="card">`;
                if (b.hasCover) html += `<img src="${b.coverUrl}" onerror="this.src='https://via.placeholder.com/400x600/e2e8f0/4a5a6a?text=No+Cover'">`;
                else html += `<div class="nocover"><i class="fas fa-book"></i></div>`;
                html += `<h3 style="font-size:0.95rem;">${b.title.substring(0, 50)}...</h3>`;
                html += `<p style="color:#475569;">${b.author}</p>`;
                html += `<a href="${b.filename}"><i class="fas fa-download"></i> Download</a>`;
                html += `</div>`;
            });
            
            html += `</div></div></body></html>`;
            return html;
        }

        // ============================================
        // DOWNLOAD FUNCTIONS
        // ============================================
        async function downloadAll() {
            if (books.length === 0) return alert('Generate dulu!');
            
            const zip = new JSZip();
            const domain = document.getElementById('domain').value.trim().replace(/^https?:\/\//, '').replace(/\/$/, '');
            const smartlink = document.getElementById('smartlink').value.trim();
            const histatsScript = document.getElementById('histatsScript').value;
            
            const folder = zip.folder(`open-library-${books.length}books`);
            
            for (let i = 0; i < books.length; i++) {
                const html = generateLandingPage(books[i], domain, smartlink, histatsScript);
                folder.file(books[i].filename, html);
                if (i % 50 === 0) await new Promise(r => setTimeout(r, 5));
            }
            
            folder.file('sitemap.xml', generateSitemap(books, domain));
            folder.file('index.html', generateIndexHTML(books, domain));
            
            const zipBlob = await zip.generateAsync({ type: 'blob' });
            saveAs(zipBlob, `open-library-${books.length}books-${Date.now()}.zip`);
        }

        function downloadSitemap() {
            if (books.length === 0) return alert('Generate dulu!');
            const domain = document.getElementById('domain').value.trim().replace(/^https?:\/\//, '').replace(/\/$/, '');
            const blob = new Blob([generateSitemap(books, domain)], { type: 'application/xml' });
            saveAs(blob, `sitemap-${Date.now()}.xml`);
        }

        // INITIALIZE
        window.onload = function() {
            setTitleMode('random');
            const defaultSmartlink = 'https://adsterra.com/referral/your-id';
            updateBannerPreviews(defaultSmartlink);
            updateDescriptionPreview();
        };
    </script>
</body>
</html>
